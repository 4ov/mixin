var e=require("zod");function t(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var r=/*#__PURE__*/t(require("cross-fetch")),n=e.z.object({name:e.z.string(),args:e.z.any().array()}),o=n.extend({type:e.z.literal("single")}),s=e.z.object({type:e.z.literal("group"),content:n.array()}),a=e.z.object({status:e.z.literal("fulfilled"),value:e.z.any()}),i=e.z.object({status:e.z.literal("rejected"),reason:e.z.any()}),u=a.or(i),c=u,l=u.array(),f=c.or(l),p=o.or(s),h=e.z.object({name:e.z.string(),message:e.z.string(),cause:e.z.any().optional(),stack:e.z.string().optional()});function y(){return y=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},y.apply(this,arguments)}function v(e){return v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},v(e)}function d(e,t){return d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e},d(e,t)}function m(e,t,r){return m=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}()?Reflect.construct.bind():function(e,t,r){var n=[null];n.push.apply(n,t);var o=new(Function.bind.apply(e,n));return r&&d(o,r.prototype),o},m.apply(null,arguments)}function g(e){var t="function"==typeof Map?new Map:void 0;return g=function(e){if(null===e||-1===Function.toString.call(e).indexOf("[native code]"))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,r)}function r(){return m(e,arguments,v(this).constructor)}return r.prototype=Object.create(e.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),d(r,e)},g(e)}function b(e){return e instanceof Error?{message:e.message,name:e.name,cause:e.cause,stack:e.stack}:(console.log(e),y({},e))}function j(e){var t=h.safeParse(e);if(t.success){var r=t.data;return new(/*#__PURE__*/function(e){var t,n;function o(){for(var t,n=arguments.length,o=new Array(n),s=0;s<n;s++)o[s]=arguments[s];return(t=e.call.apply(e,[this].concat(o))||this).name=r.name,t.message=r.message,t.cause=r.cause,t.stack=r.stack,t}return n=e,(t=o).prototype=Object.create(n.prototype),t.prototype.constructor=t,d(t,n),o}(/*#__PURE__*/g(Error)))}return new Error(e)}var P,w=/*#__PURE__*/function(){function e(e,t,r){this.url=void 0,this.fnName=void 0,this.fnArgs=void 0,this.url=e,this.fnName=t,this.fnArgs=r}var t=e.prototype;return t.single=function(){try{var e=this;try{return Promise.resolve(r.default(e.url,{method:"POST",body:JSON.stringify({type:"single",name:e.fnName,args:e.fnArgs}),headers:{"Content-Type":"application/json"}}).then(function(e){return e.json()}).then(function(e){return c.safeParse(e)}).then(function(e){if(e.success)return e.data;throw new Error("bad Response")}).then(function(e){if("fulfilled"===e.status)return e.value;throw j(e.reason)}))}catch(e){throw new Error("bad Response")}}catch(e){return Promise.reject(e)}},t.then=function(e,t){return this.single().then(e,t)},e}(),x=Symbol("Base");e.z.object(((P={})[x]=e.z.literal(!0).default(!0),P));var O=/*#__PURE__*/function(){function e(e,t,r){this.context=void 0,this.functions=void 0,this.shape=void 0,this.context=r;var n=e.safeParse(t);if(!n.success)throw new Error("Functions are not compatable");this.functions=n.data,this.shape=e.shape}var t=e.prototype;return t.call=function(e,t,r){try{var n=this;if(Object.hasOwn(n.functions,e)){var o,s,a,i=n.functions[e];return!(null==(o=n.shape[e].parameters().items)||null==(s=o[0])||null==(a=s.shape)||!a[x])&&(t=[r].concat(t)),Promise.resolve(function(e,r){try{var n=Promise.resolve(i.apply(void 0,t)).then(function(e){return{status:"fulfilled",value:e}})}catch(e){return r(e)}return n&&n.then?n.then(void 0,r):n}(0,function(e){return{status:"rejected",reason:b(e)}}))}var u={status:"rejected",reason:b(new Error("Function Not Found"))};return Promise.resolve(u)}catch(e){return Promise.reject(e)}},t.single=function(e,t){try{var r=e.args,n=e.name;if(Object.hasOwn(this.functions,n))return Promise.resolve(this.call(n,r,t));throw new Error("Not found")}catch(e){return Promise.reject(e)}},t.group=function(e,t){try{var r=this;return Promise.resolve(Promise.allSettled(e.content.map(function(e){try{return Promise.resolve(r.single(e,t))}catch(e){return Promise.reject(e)}})))}catch(e){return Promise.reject(e)}},t.handle=function(e,t){try{var r=this,n=r.context.safeParse(t);if(!n.success)throw new Error("Bad Context");var o=n.data,s=p.safeParse(e);if(!s.success)throw new Error("Bad Request form",{cause:s.error.message});var a=s.data;return Promise.resolve("single"===a.type?r.single(a,o):r.group(a,o))}catch(e){return Promise.reject(e)}},e}();exports.BaseRequest=n,exports.BaseResponse=u,exports.BaseResponseFullfilled=a,exports.BaseResponseRejected=i,exports.ErrorToJson=b,exports.GroupRequest=s,exports.GroupResponse=l,exports.Handler=O,exports.JsonToError=j,exports.MixinError=h,exports.MixinRequest=p,exports.MixinResponse=f,exports.SingleRequest=o,exports.SingleResponse=c,exports.compile=function(e,t){return new Proxy({},{get:function(e,r,n){if("$"===r)throw new Error("not implemented");return function(){try{var e=arguments;return Promise.resolve(new w(t,r.toString(),[].slice.call(e)))}catch(e){return Promise.reject(e)}}}})};
//# sourceMappingURL=index.cjs.map
